{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2023-02-28-practical-aws-cli-examples/","result":{"data":{"site":{"siteMetadata":{"title":"Beveloper","heroImage":"/images/beveloper-hero.jpg"}},"markdownRemark":{"id":"43971360-944e-5840-859f-7a4d02db93cd","excerpt":"How to find AMI ID First, need to determine 2 variables: AWS Region Code AWS AMI Product ID The same product would have different AMI IDs in different regionsâ€¦","html":"<h1>How to find AMI ID</h1>\n<p>First, need to determine 2 variables:</p>\n<ul>\n<li>AWS Region Code</li>\n<li>AWS AMI Product ID</li>\n</ul>\n<p>The same product would have different AMI IDs in different regions.</p>\n<h2>How to find an AWS Region Code</h2>\n<p>Find a region you prefer in <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html#concepts-regions\">Regions and Zones of AWS EC2</a>.</p>\n<h2>How to find an AWS AMI Product ID</h2>\n<ol>\n<li>\n<p>Go to <a href=\"https://us-east-1.console.aws.amazon.com/marketplace/home\">AWS Marketplace - Discover products</a> page to search a product you prefer.</p>\n</li>\n<li>\n<p>Click into the product detail page and click <strong>\"Continue to Subscribe\"</strong> button.</p>\n</li>\n<li>\n<p>You must review and accept terms to subscribe. Without subscription, you could not use this product in AWS CLI.</p>\n</li>\n<li>\n<p>In current page url, you would see the product id \"productId=xxxxxxxx\"</p>\n<h3>My favorate images:</h3>\n<ul>\n<li>WordPress Certified by Bitnami and Automattic (Apache) : <code class=\"language-text\">7d426cb7-9522-4dd7-a56b-55dd8cc1c8d0</code></li>\n<li>WordPress with NGINX and SSL Certified by Bitnami and Automattic: <code class=\"language-text\">78b1d030-4c7d-4ade-b8e6-f8dc86941303</code></li>\n</ul>\n</li>\n</ol>\n<h2>List the AMI IDs by Product ID</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">```bash\nregion=\"us-west-2\"\nproduct_id=\"7d426cb7-9522-4dd7-a56b-55dd8cc1c8d0\";\n\naws ec2 describe-images \\\n--region $region \\\n--filters \"Name=name,Values=*${product_id}*\" \\\n--owners aws-marketplace \\\n--query 'Images[*].[ImageId,CreationDate,OwnerId,Name]' \\\n--output text \\\n| sort -k2 -r \\\n| head -n10 \\\n| tee /dev/null\n```</code></pre></div>\n<h2>List the AMI IDs of AWS Official</h2>\n<p>If the AMI is one of AWS Official's, you don't need to subscribe.</p>\n<p>The Owner ID of AWS is <code class=\"language-text\">099720109477</code>. You could change it to others.</p>\n<p>The keyword is a string, but could involve '*'.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\">#</span>\n<span class=\"token assign-left variable\">region</span><span class=\"token operator\">=</span><span class=\"token string\">\"us-west-2\"</span>\n<span class=\"token assign-left variable\">keyword</span><span class=\"token operator\">=</span><span class=\"token string\">\"jammy*22.04*amd64\"</span>\n<span class=\"token assign-left variable\">owner_id</span><span class=\"token operator\">=</span><span class=\"token string\">\"099720109477\"</span>\n\naws ec2 describe-images <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--region</span> <span class=\"token variable\">$region</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--filters</span> <span class=\"token assign-left variable\">Name</span><span class=\"token operator\">=</span>name,Values<span class=\"token operator\">=</span><span class=\"token punctuation\">\\</span>*<span class=\"token variable\">${keyword}</span><span class=\"token punctuation\">\\</span>* <span class=\"token parameter variable\">--owners</span> <span class=\"token variable\">$owner_id</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--query</span> <span class=\"token string\">'Images[*].[ImageId,CreationDate,OwnerId,Name]'</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--output</span> text <span class=\"token punctuation\">\\</span>\n<span class=\"token operator\">|</span> <span class=\"token function\">sort</span> <span class=\"token parameter variable\">-k2</span> <span class=\"token parameter variable\">-r</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token operator\">|</span> <span class=\"token function\">head</span> <span class=\"token parameter variable\">-n10</span></code></pre></div>\n<h1>How to get AZs of a region</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">region</span><span class=\"token operator\">=</span><span class=\"token string\">\"ap-east-1\"</span>\n\n<span class=\"token assign-left variable\">az_list</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span>aws ec2 describe-availability-zones <span class=\"token parameter variable\">--region</span> $region <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--query</span> <span class=\"token string\">'AvailabilityZones[?State==`available`].[ZoneName]'</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--output</span> text<span class=\"token variable\">)</span></span>\n<span class=\"token builtin class-name\">printf</span> <span class=\"token string\">'['</span>\n<span class=\"token keyword\">while</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">IFS</span></span><span class=\"token operator\">=</span> <span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-r</span> line<span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span>\n    <span class=\"token builtin class-name\">printf</span> <span class=\"token string\">\"<span class=\"token entity\" title=\"\\&quot;\">\\\"</span><span class=\"token variable\">$line</span><span class=\"token entity\" title=\"\\&quot;\">\\\"</span>, \"</span>\n<span class=\"token keyword\">done</span> <span class=\"token operator\">&lt;&lt;&lt;</span> <span class=\"token string\">\"<span class=\"token variable\">$az_list</span>\"</span>\n<span class=\"token builtin class-name\">printf</span> <span class=\"token string\">']'</span></code></pre></div>\n<h1>List Lightsail Blueprint IDs</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws lightsail get-blueprints <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--query</span> <span class=\"token string\">'blueprints[*].[blueprintId,version,name,type]'</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--output</span> text <span class=\"token punctuation\">\\</span>\n<span class=\"token operator\">|</span> <span class=\"token function\">sort</span> <span class=\"token parameter variable\">-k1</span></code></pre></div>","frontmatter":{"title":"Practical AWS CLI Examples","date":"2023-02-28T00:00:00+00:00","description":"During development work, created some very useful AWS CLI commands.","featuredImageUrl":"https://miro.medium.com/max/1017/1*O5H_uWG53Ho784fLSWEq6Q.png"}},"previous":{"fields":{"slug":"/2023-02-28-practical-shell-script-snippets/"},"frontmatter":{"title":"Practical Shell Script Snippets"}},"next":{"fields":{"slug":"/2023-02-07-the-feeling-of-scrolling-of-flutter-web/"},"frontmatter":{"title":"The Weird Feeling of Scrolling of Flutter Web"}}},"pageContext":{"id":"43971360-944e-5840-859f-7a4d02db93cd","previousPostId":"c136a23a-ab19-5a10-a7d5-d39fc30c9415","nextPostId":"337739fc-1457-57de-95a9-1387ec50f4bf"}},"staticQueryHashes":["1261413882","2660733687"]}